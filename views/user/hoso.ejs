<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>now food</title>
    <link rel="stylesheet" href="/css/home.css">
    <link rel="stylesheet" href="/css/hoso.css">
    <link rel="stylesheet" href="/css/nhanvien.css">
    <link rel="stylesheet" href="/css/gioithieu.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />




</head>

<body>
    <div id="header">
        <a href="" class="logo">
            <img src="../images/logo1.png" alt="">
        </a>
        <div id="menu">
            <div class="item">

                <a href="/user/home">Trang chủ</a>
            </div>
            <% if(user.length){ %>
                <div class="item">
                    <a href="/user/gioithieu">Giới Thiệu </a>
                </div>
                <div class="item">
                    <a href="/user/sanpham">Sản Phẩm</a>
                </div>
                <div class="item">
                    <a href="/user/lienhe">Liên hệ </a>
                </div>
                <div class="item">
                    <a href="/user/status">status </a>
                </div>
        </div>
        <div id="actions">
            <div class="item">
                <a href="/user/cart"><i class="fa-solid fa-cart-shopping"></i></a>
            </div>
            <div class="item">
                <a href="/user/lichsu"><i class="fa-regular fa-file"></i></a>
            </div>
            <div class="item">
                <a href="#" id="showChat"> <i class="fa-brands fa-facebook-messenger"></i></a>
            </div>
            <div class="item">
                <a href="/user/hoso"><i class="fa-regular fa-circle-user"></i></a>
            </div>
            <div class="item">
                <a href="/user/login" id="logoutLink"><i class="fa-solid fa-arrow-right-from-bracket"></i></i></a>
            </div>
            <div id="logoutConfirmation" class="confirmation">
                <p>Bạn có chắc chắn muốn đăng xuất?</p>
                <button id="confirmLogout">Đồng ý</button>
                <button id="cancelLogout">Hủy</button>
            </div>
        </div>
        <% } else { %>
            <div class="item">
                <a href="/user/gioithieu">Giới Thiệu </a>
            </div>
    </div>
    <div id="actions">
        <div class="item">
            <a href="/user/login">đăng nhập </i></a>
        </div>
        <div class="item">
            <a href="/user/dangki">đăng kí</i></a>
        </div>

    </div>
    <% } %>

        </div>


        <div class="container">
            <div class="abcd"></div>
            <div class="container_hoso">
                <div class="container_header">
                    <h1 class="tieude">Hồ sơ của tôi</h1>
                    <p class="doanvan">Quản lý thông tin hồ sơ để bảo mật tài khoản</p>
                </div>
                <div class="row">
                    <div class="container_thongtin">
                        <form>
                            <table class="table">
                                <tr class="table_tr">
                                    <td class="table_td1"><i class="fa-solid fa-envelope vitri"></i><label
                                            style="color:rgba(85,85,85,.8);">Email</label></td>
                                    <td class="table_td2">
                                        <%= user1.email %>
                                    </td>
                                </tr>
                                <tr class="table_tr">
                                    <td class="table_td1"><i class="fa-solid fa-user vitri"></i><label
                                            style="color:rgba(85,85,85,.8);">Tên</label></td>
                                    <td class="table_td2">
                                        <%= user1.name %>
                                    </td>
                                </tr>
                                <tr class="table_tr">
                                    <td class="table_td1"><i class="fa-solid fa-phone vitri "></i><label
                                            style="color:rgba(85,85,85,.8);">Số Điện Thoại</label></td>
                                    <td class="table_td2">
                                        <%= user1.phone %>
                                    </td>
                                </tr>
                                <tr class="table_tr">
                                    <td class="table_td1"><i class="fa-solid fa-location-dot vitri"></i><label
                                            style="color:rgba(85,85,85,.8);">Địa chỉ</label></td>
                                    <td class="table_td2">
                                        <%= user1.diachi %>
                                    </td>
                                </tr>
                                <tr class="table_tr">
                                    <td class="table_td1"><i class="fa-solid fa-venus-mars vitri"></i><label
                                            style="color:rgba(85,85,85,.8);">Giới tính</label></td>
                                    <td class="table_td2">
                                        <%= user1.gioitinh %>
                                    </td>
                                </tr>
                                <tr class="table_tr">
                                    <td class="table_td1"><i class="fa-regular fa-calendar-days vitri "></i><label
                                            style="color:rgba(85,85,85,.8);">Ngày Sinh</label></td>
                                    <td class="table_td2">
                                        <%= user1.ngaysinh %>
                                    </td>
                                </tr>
                            </table>
                        </form>
                    </div>
                    <div class="container-chucnang">
                        <img class="anh" src="../images/a1.png" alt="">
                        <div class="row1">
                            <i class="fa-solid fa-pen icon_sua"></i>
                            <a class="a_sua open-update-form" href="#" data-user-id="<%= user1._id%>">Sửa hồ sơ</a>
                            <form method="POST" action="/user/updatethongtin/<%= user1._id %>" class="update-form"
                                id="form_<%= user1._id %>" style="display: none;">

                                <div class="form-group">
                                    <label for="form-update_name">Email:</label>
                                    <input type="text" id="form-update_name" name="email" class="form-control"
                                        value="<%= user1.email %>" required>
                                </div>
                                <div class="form-group">
                                    <label for="form-update_anh">Name:</label>
                                    <input type="text" id="form-update_anh" name="name" class="form-control"
                                        value="<%= user1.name %>" required>
                                </div>
                                <div class="form-group">
                                    <label for="form-update_gia">Phone:</label>
                                    <input type="text" id="form-update_gia" name="phone" class="form-control"
                                        value="<%= user1.phone %>" required>
                                </div>
                                <div class="form-group">
                                    <label for="form-update_danhMuc">Địa chỉ:</label>
                                    <input type="text" id="form-update_danhMuc" name="diachi" class="form-control"
                                        value="<%= user1.diachi %>" required>
                                </div>
                                <div class="form-group">
                                    <label for="form-update_moTa">Ngày sinh:</label>
                                    <input type="text" id="form-update_moTa" name="ngaysinh" class="form-control"
                                        value="<%= user1.ngaysinh %>" required>
                                </div>
                                <div class="form-group">
                                    <label for="form-update_moTa">Giới tính:</label>
                                    <input type="text" id="form-update_moTa" name="gioitinh" class="form-control"
                                        value="<%= user1.gioitinh %>" required>
                                </div>
                                <button type="submit" class="btn btn-primary">Lưu</button>
                                <button type="button" class="btn btn-danger close-form">Đóng</button>
                            </form>
                        </div>
                        <div class="row1">
                            <a class="p_sua ">đổi mật khẩu </a>
                            <button style="margin-left:3px;" class="button_thaydoi open-update-form2" data-user-id="<%= user1._id%>">thay đổi</button>
                            <form method="POST" action="/user/updatepassword/<%= user1._id %>" class="update-form2"
                                id="form_<%= user1._id %>" style="display: none;" onsubmit="return validateForm()">

                                <div class="form-group">
                                    <label for="form-update_name1">mật khẩu cũ</label>
                                    <input type="password" id="form-update_name1" name="oldPassword" class="form-control"
                                         required>
                                </div>
                                <div class="form-group">
                                    <label for="form-update_anh1">Mật khẩu mới:</label>
                                    <input type="password" id="form-update_anh1" name="newPassword" class="form-control"
                                         required>
                                </div>
                                <div class="form-group">
                                    <label for="form-update_gia1">nhập lại mật khẩu:</label>
                                    <input type="password" id="form-update_gia1" class="form-control"
                                         required>
                                </div>
                                
                                <button type="submit" class="btn btn-primary">Lưu</button>
                                <button type="button" class="btn btn-danger close-form">Đóng</button>
                            </form>
                        </div>

                    </div>
                </div>
            </div>
        </div>




        <div id="footer">
            <div class="box">
                <div class="logo"><img src="../images/logo1.png" alt=""> </div>
                <p>Cung cấp sản phẩm với chất lượng an toàn cho quý khách </p>

            </div>
            <div class="box">
                <h3> Thông Tin</h3>
                <ul class="quick-menu">
                    <div class="item">
                        <a href="">tel:0965274564</a>
                    </div>
                    <div class="item">
                        <a href="">adress:số 18,phố Tạ Quang Bửu</a>
                    </div>
                    <div class="item">
                        <a href="">FaceBook </a>
                    </div>
                </ul>

            </div>
            <div class="box">
                <h3>LIÊN HỆ</h3>
                <form action="">
                    <input type="text" placeholder="Địa chỉ mail">
                    <button>Gửi tin</button>
                </form>

            </div>

        </div>

        </div>
        <div class="wraper" style="height:200px;width:300px ;display: none;z-index:9999;position: fixed;
    top: 80px;
    left: 10px;
     box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);" id="chatBox">
        <section>
            <header  style="background-color: orange; border-radius: 2px; height: 40px; position: relative;">
                <div >
                    <img  style="height:20px; width:20px ;border-radius:50%; margin-top:10px;margin-left:20px"    src="https://tse4.mm.bing.net/th?id=OIP.kQyrx9VbuWXWxCVxoreXOgHaHN&pid=Api&P=0&h=180" atl="">
                    <span style="margin-bottom: 5px;color:white;">Admin</span>
                    <i id="closeChat" style="position: absolute; top: 0; right: 0; margin-top: 10px; margin-right: 10px; cursor: pointer;" class="fa-solid fa-xmark"></i>

                </div>
            </header>
            <div class="chat-box">
                <div class="chat outgoing">
                    <div class="details">
                        <p>hello</p>
                    </div>
                </div>
                <div class=" chat incoming">
                    <div class="details">
                        <p>hi</p>
                    </div>
                </div>
            </div>
            <form action="#" class="typing-area" style="background-color: orange;border-radius: 3px;">
                <input type="text " name="incoming_id" class="incoming_id" id="" hidden>
                <input type="text" name="message" class="input-field " placeholder="nhập nội dung">
                <button>
                    <i class="fab fa-telegram-plane"></i>
                </button>
            </form>
        </section>
    </div>
        <script type="text/javascript" src="../js/logout.js"></script>
        <script>
            // Xử lý khi nhấn vào biểu tượng "Update"
            document.querySelectorAll('.open-update-form').forEach(function (button) {
                button.addEventListener('click', function (event) {
                    // Ngăn chuyển hướng mặc định của thẻ 'a'
                    event.preventDefault();

                    // Ẩn tất cả các form sửa thông tin khác (nếu có)
                    document.querySelectorAll('.update-form').forEach(function (form) {
                        form.style.display = 'none';
                    });

                    // Hiển thị form sửa thông tin tương ứng
                    var userId = this.getAttribute('data-user-id');

                    document.querySelector('.update-form[id="form_' + userId + '"]').style.display = 'block';
                    console.log(document.querySelector('.update-form[id="form_' + userId + '"]').style.display = 'block');
                });
            });

            // Xử lý khi nhấn vào biểu tượng "Close"
            document.querySelectorAll('.close-form').forEach(function (closeButton) {
                closeButton.addEventListener('click', function () {
                    // Đóng form
                    this.closest('.update-form').style.display = 'none';
                });
            });
        </script>
         <script>
            // Xử lý khi nhấn vào biểu tượng "Update"
            document.querySelectorAll('.open-update-form2').forEach(function (button) {
                button.addEventListener('click', function (event) {
                    // Ngăn chuyển hướng mặc định của thẻ 'a'
                    event.preventDefault();

                    // Ẩn tất cả các form sửa thông tin khác (nếu có)
                    document.querySelectorAll('.update-form2').forEach(function (form) {
                        form.style.display = 'none';
                    });

                    // Hiển thị form sửa thông tin tương ứng
                    var userId = this.getAttribute('data-user-id');

                    document.querySelector('.update-form2[id="form_' + userId + '"]').style.display = 'block';
                    console.log(document.querySelector('.update-form2[id="form_' + userId + '"]').style.display = 'block');
                });
            });

            // Xử lý khi nhấn vào biểu tượng "Close"
            document.querySelectorAll('.close-form').forEach(function (closeButton) {
                closeButton.addEventListener('click', function () {
                    // Đóng form
                    this.closest('.update-form2').style.display = 'none';
                });
            });
        </script>
        <script>
            function validateForm() {
                // Lấy giá trị của các trường nhập liệu
                var oldPassword = document.getElementById('form-update_name1').value;
                var newPassword = document.getElementById('form-update_anh1').value;
                var confirmPassword = document.getElementById('form-update_gia1').value;
        
                // Kiểm tra xem tất cả các trường đều đã được nhập
                if (!oldPassword || !newPassword || !confirmPassword) {
                    alert('Vui lòng nhập đầy đủ thông tin');
                    return false;
                }
                 console.log(newPassword);
                 console.log(confirmPassword);
                 
                // Kiểm tra xem mật khẩu mới và nhập lại mật khẩu có khớp nhau không
                if (newPassword !== confirmPassword) {
                    alert('Mật khẩu mới và nhập lại mật khẩu không khớp');
                    return false;
                }
        
                // Kiểm tra các điều kiện khác nếu cần
        
                // Nếu mọi thứ đều hợp lệ, cho phép form được gửi đi
                return true;
            }
        </script>
         <script>
            document.addEventListener('DOMContentLoaded', function() {
      const showChatButton = document.getElementById('showChat');
      const closeChatIcon = document.getElementById('closeChat');
      const chatBox = document.getElementById('chatBox');
    
      // Toggle chat box display on button click
      showChatButton.addEventListener('click', function() {
        if (chatBox.style.display === 'none' || chatBox.style.display === '') {
          chatBox.style.display = 'block';
        } else {
          chatBox.style.display = 'none';
        }
      });
      closeChatIcon.addEventListener('click', function() {
        chatBox.style.display = 'none';
      });
    });
        </script>
</body>